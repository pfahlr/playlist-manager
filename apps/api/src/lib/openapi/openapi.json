{
  "openapi": "3.1.0",
  "info": {
    "title": "playlist-manager API",
    "version": "1.0.0",
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "https://api.playlist-manager.app/api/v1",
      "description": "Production API"
    },
    {
      "url": "http://{host}:{port}/api/v1",
      "description": "Local development",
      "variables": {
        "host": {
          "default": "127.0.0.1"
        },
        "port": {
          "default": "3101"
        }
      }
    }
  ],
  "security": [
    {}
  ],
  "tags": [
    {
      "name": "auth",
      "description": "Authentication provider metadata"
    },
    {
      "name": "playlists",
      "description": "Playlist management endpoints"
    },
    {
      "name": "active-playlist",
      "description": "Active playlist controls for a user session"
    },
    {
      "name": "jobs",
      "description": "Background job submission and status"
    },
    {
      "name": "exports",
      "description": "Export playlist snapshots into provider formats"
    },
    {
      "name": "artists",
      "description": "Artist catalogue and follow operations"
    },
    {
      "name": "imports",
      "description": "Upload playlist files for validation and preview"
    }
  ],
  "paths": {
    "/auth/providers": {
      "get": {
        "summary": "List enabled auth providers",
        "operationId": "authProviders_list",
        "tags": [
          "auth"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "data"
                  ],
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/AuthProvider"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/playlists": {
      "get": {
        "summary": "List user playlists",
        "operationId": "playlists_list",
        "parameters": [
          {
            "in": "query",
            "name": "provider",
            "schema": {
              "type": "string",
              "enum": [
                "spotify",
                "deezer",
                "tidal",
                "youtube"
              ]
            }
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 500,
              "default": 100
            }
          },
          {
            "in": "query",
            "name": "cursor",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PagedPlaylists"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/playlists/{id}": {
      "get": {
        "summary": "Get a playlist",
        "operationId": "playlists_get",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "example": 101,
            "schema": {
              "type": "integer",
              "example": 101,
              "default": 101
            },
            "examples": {
              "default": {
                "value": 101
              }
            },
            "x-example": 101
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Playlist"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/playlists/{id}/items": {
      "get": {
        "summary": "List playlist items (effective fields by default)",
        "operationId": "playlists_items_list",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "example": 101,
            "schema": {
              "type": "integer",
              "example": 101,
              "default": 101
            },
            "examples": {
              "default": {
                "value": 101
              }
            },
            "x-example": 101
          },
          {
            "in": "query",
            "name": "effective",
            "schema": {
              "type": "boolean",
              "default": true
            }
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 500,
              "default": 100
            }
          },
          {
            "in": "query",
            "name": "cursor",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "order",
            "schema": {
              "type": "string",
              "enum": [
                "position",
                "added_at"
              ],
              "default": "position"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "ETag": {
                "schema": {
                  "type": "string"
                }
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PagedPlaylistItems"
                },
                "examples": {
                  "demo": {
                    "summary": "Example effective items page",
                    "value": {
                      "data": [
                        {
                          "id": 101,
                          "position": 1,
                          "title": "Losing My Religion",
                          "artists": "R.E.M.",
                          "album": "Out of Time",
                          "duration_ms": 269000,
                          "isrc": "USWB19902945",
                          "recording_id": 5551,
                          "mb_recording_id": "b8d0d7c0-8e1c-4b34-8bc3-38d78a0c2b1f",
                          "mb_release_id": "b7a6d2e4-1c77-4a9f-9d5b-0c3b2ea0f4a1",
                          "provider_track_id": "3urbQpVxWn"
                        },
                        {
                          "id": 102,
                          "position": 2,
                          "title": "Hurt",
                          "artists": "Nine Inch Nails",
                          "album": "The Downward Spiral",
                          "duration_ms": 371000,
                          "isrc": "USIR19400383",
                          "recording_id": 5552,
                          "mb_recording_id": "f2d9f7d3-7a61-485f-9b1e-2f4d8b3b7d1a",
                          "mb_release_id": "9c0b3c90-1e37-4b9b-8c7e-9b7a86a1e5fd",
                          "provider_track_id": "9zYpqAbC12"
                        }
                      ],
                      "next_cursor": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "422": {
            "$ref": "#/components/responses/UnprocessableEntity"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/active-playlist": {
      "get": {
        "summary": "Get the active playlist pointer",
        "operationId": "activePlaylist_get",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActivePlaylist"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      },
      "put": {
        "summary": "Set the active playlist",
        "operationId": "activePlaylist_set",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "playlist_id"
                ],
                "properties": {
                  "playlist_id": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "204": {
            "description": "No Content"
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/active-playlist/items": {
      "post": {
        "summary": "Append item to active playlist",
        "operationId": "activePlaylist_addItem",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "type": "object",
                    "required": [
                      "recording_id"
                    ],
                    "properties": {
                      "recording_id": {
                        "type": "integer"
                      },
                      "position": {
                        "type": "string",
                        "enum": [
                          "append",
                          "head"
                        ],
                        "default": "append"
                      }
                    }
                  },
                  {
                    "type": "object",
                    "required": [
                      "isrc"
                    ],
                    "properties": {
                      "isrc": {
                        "type": "string"
                      },
                      "position": {
                        "type": "string",
                        "enum": [
                          "append",
                          "head"
                        ],
                        "default": "append"
                      }
                    }
                  },
                  {
                    "type": "object",
                    "required": [
                      "title",
                      "primary_artist"
                    ],
                    "properties": {
                      "title": {
                        "type": "string"
                      },
                      "primary_artist": {
                        "type": "string"
                      },
                      "position": {
                        "type": "string",
                        "enum": [
                          "append",
                          "head"
                        ],
                        "default": "append"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PlaylistItemEffective"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/active-playlist/items/{itemId}": {
      "delete": {
        "summary": "Remove item from active playlist",
        "operationId": "activePlaylist_removeItem",
        "parameters": [
          {
            "in": "path",
            "name": "itemId",
            "required": true,
            "example": 4001,
            "schema": {
              "type": "integer",
              "example": 4001
            },
            "x-example": 4001
          }
        ],
        "responses": {
          "204": {
            "description": "No Content"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/jobs/migrate": {
      "post": {
        "summary": "Migrate a playlist between providers",
        "operationId": "jobs_requestMigration",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "source_provider",
                  "source_playlist_id",
                  "dest_provider"
                ],
                "properties": {
                  "source_provider": {
                    "type": "string",
                    "enum": [
                      "spotify",
                      "deezer",
                      "tidal",
                      "youtube"
                    ]
                  },
                  "source_playlist_id": {
                    "type": "integer"
                  },
                  "dest_provider": {
                    "type": "string",
                    "enum": [
                      "spotify",
                      "deezer",
                      "tidal",
                      "youtube"
                    ]
                  },
                  "dest_playlist_name": {
                    "type": "string"
                  }
                }
              },
              "examples": {
                "basic": {
                  "value": {
                    "source_provider": "spotify",
                    "source_playlist_id": 1,
                    "dest_provider": "tidal",
                    "dest_playlist_name": "Migrated â€” My Mix"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobRef"
                },
                "examples": {
                  "accepted": {
                    "value": {
                      "job_id": 456,
                      "status": "queued"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          },
          "503": {
            "$ref": "#/components/responses/ServiceUnavailable"
          }
        }
      }
    },
    "/jobs/{id}": {
      "get": {
        "summary": "Get job status/report",
        "operationId": "jobs_get",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "example": 5001,
            "schema": {
              "type": "integer",
              "example": 5001,
              "default": 5001
            },
            "examples": {
              "default": {
                "value": 5001
              }
            },
            "x-example": 5001
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Job"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/imports/file": {
      "post": {
        "summary": "Preview a playlist file import",
        "operationId": "imports_file_preview",
        "tags": [
          "imports"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "text/csv": {
              "schema": {
                "type": "string",
                "description": "CSV playlist export (lean or verbose)"
              },
              "examples": {
                "lean": {
                  "summary": "Lean CSV",
                  "value": "position,title,artists,album,duration_ms,isrc\n1,\"Shadowboxing\",\"Neon District; Aria Blaze\",\"Midnight Canvas\",225000,US-AAA-23-00001\n2,\"Daybreak\",\"Solar Mist\",\"Aurora Dreams\",252000,US-AAA-23-00002"
                },
                "verbose": {
                  "summary": "Verbose CSV",
                  "value": "position,title,artists,album,release_date,disc_number,track_number,duration_ms,explicit,isrc,mb_recording_id,mb_release_id,mb_release_group_id,mb_artist_ids,spotify_track_id,spotify_album_id,deezer_track_id,deezer_album_id,tidal_track_id,tidal_album_id,youtube_video_id,amazon_track_id,upc,iswc,genres,source_service,source_playlist_id\n1,\"Shadowboxing\",\"Neon District; Aria Blaze\",\"Midnight Canvas\",2023-07-01,,,\"225000\",false,US-AAA-23-00001,,,,\"\",spotify123,,,,tidal456,,,,,,\"synthwave;nightdrive\",\"spotify\",\"focus123\"\n2,\"Daybreak\",\"Solar Mist\",\"Aurora Dreams\",,,,\"252000\",,,US-AAA-23-00002,,,,,,,,yt456,,,,,,\"\",\"spotify\",\"focus123\""
                }
              }
            },
            "audio/x-mpegurl": {
              "schema": {
                "type": "string"
              },
              "examples": {
                "m3u": {
                  "summary": "Extended M3U playlist",
                  "value": "#EXTM3U\n#PLAYLIST:Focus Flow\n#EXTALB:Midnight Canvas\n#EXTINF:225,Neon District; Aria Blaze - Shadowboxing\nhttps://open.spotify.com/track/abc123?si=foo\n#EXTALB:Aurora Dreams\n#EXTINF:252,Solar Mist - Daybreak\nhttps://www.youtube.com/watch?v=yt456&list=LL"
                }
              }
            },
            "application/xspf+xml": {
              "schema": {
                "type": "string"
              },
              "examples": {
                "xspf": {
                  "summary": "XSPF playlist",
                  "value": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<playlist version=\"1\" xmlns=\"http://xspf.org/ns/0/\">\n  <title>Focus Flow</title>\n  <trackList>\n    <track>\n      <title>Shadowboxing</title>\n      <creator>Neon District; Aria Blaze</creator>\n      <album>Midnight Canvas</album>\n      <duration>225000</duration>\n      <location>https://open.spotify.com/track/abc123?si=foo</location>\n    </track>\n    <track>\n      <title>Daybreak</title>\n      <creator>Solar Mist</creator>\n      <album>Aurora Dreams</album>\n      <duration>252000</duration>\n      <location>https://www.youtube.com/watch?v=yt456&amp;list=LL</location>\n    </track>\n  </trackList>\n</playlist>"
                }
              }
            },
            "audio/x-scpls": {
              "schema": {
                "type": "string"
              },
              "examples": {
                "pls": {
                  "summary": "PLS playlist",
                  "value": "[playlist]\nNumberOfEntries=2\nFile1=https://open.spotify.com/track/abc123?si=foo\nTitle1=Neon District; Aria Blaze - Shadowboxing\nLength1=225\nFile2=https://www.youtube.com/watch?v=yt456&list=LL\nTitle2=Solar Mist - Daybreak\nLength2=252\nVersion=2"
                }
              }
            },
            "application/vnd.ms-wpl": {
              "schema": {
                "type": "string"
              },
              "examples": {
                "wpl": {
                  "summary": "Windows Media Player playlist",
                  "value": "<?wpl version=\"1.0\"?>\n<smil>\n  <head>\n    <title>Focus Flow</title>\n  </head>\n  <body>\n    <seq>\n      <media src=\"https://open.spotify.com/track/abc123?si=foo\">\n        <param name=\"Title\" value=\"Shadowboxing\" />\n        <param name=\"Author\" value=\"Neon District; Aria Blaze\" />\n        <param name=\"AlbumTitle\" value=\"Midnight Canvas\" />\n        <param name=\"Duration\" value=\"225000\" />\n      </media>\n      <media src=\"https://www.youtube.com/watch?v=yt456&amp;list=LL\">\n        <param name=\"Title\" value=\"Daybreak\" />\n        <param name=\"Author\" value=\"Solar Mist\" />\n        <param name=\"AlbumTitle\" value=\"Aurora Dreams\" />\n        <param name=\"Duration\" value=\"252000\" />\n      </media>\n    </seq>\n  </body>\n</smil>"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Parsed playlist preview",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileImportPreviewResponse"
                },
                "examples": {
                  "m3uPreview": {
                    "summary": "M3U preview",
                    "value": {
                      "preview": {
                        "name": "Focus Flow",
                        "description": null,
                        "source_service": null,
                        "source_playlist_id": null,
                        "tracks": [
                          {
                            "position": 1,
                            "title": "Shadowboxing",
                            "artists": [
                              "Neon District",
                              "Aria Blaze"
                            ],
                            "album": "Midnight Canvas",
                            "duration_ms": 225000,
                            "explicit": null,
                            "release_date": null,
                            "isrc": null,
                            "mb_recording_id": null,
                            "mb_release_id": null,
                            "provider_ids": {
                              "spotify_track_id": "abc123"
                            }
                          },
                          {
                            "position": 2,
                            "title": "Daybreak",
                            "artists": [
                              "Solar Mist"
                            ],
                            "album": "Aurora Dreams",
                            "duration_ms": 252000,
                            "explicit": null,
                            "release_date": null,
                            "isrc": null,
                            "mb_recording_id": null,
                            "mb_release_id": null,
                            "provider_ids": {
                              "youtube_video_id": "yt456"
                            }
                          }
                        ]
                      },
                      "counts": {
                        "tracks": 2
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/exports/file": {
      "post": {
        "summary": "Export a playlist to file",
        "operationId": "exports_enqueueFile",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "playlist_id",
                  "format"
                ],
                "properties": {
                  "playlist_id": {
                    "type": "integer"
                  },
                  "format": {
                    "type": "string",
                    "enum": [
                      "m3u",
                      "xspf",
                      "csv"
                    ]
                  },
                  "variant": {
                    "type": "string",
                    "enum": [
                      "lean",
                      "verbose"
                    ],
                    "default": "lean"
                  }
                }
              },
              "examples": {
                "csvLean": {
                  "value": {
                    "playlist_id": 1,
                    "format": "csv",
                    "variant": "lean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobRef"
                },
                "examples": {
                  "accepted": {
                    "value": {
                      "job_id": 123,
                      "status": "queued"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/artists/{mbid}/follow": {
      "post": {
        "summary": "Follow an artist by MBID",
        "operationId": "artists_follow",
        "parameters": [
          {
            "in": "path",
            "name": "mbid",
            "required": true,
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "schema": {
              "type": "string",
              "pattern": "^[0-9a-fA-F-]{36}$",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "default": "123e4567-e89b-12d3-a456-426614174000"
            },
            "examples": {
              "default": {
                "value": "123e4567-e89b-12d3-a456-426614174000"
              }
            },
            "x-example": "123e4567-e89b-12d3-a456-426614174000"
          }
        ],
        "responses": {
          "204": {
            "description": "No Content"
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      },
      "delete": {
        "summary": "Unfollow artist",
        "operationId": "artists_unfollow",
        "parameters": [
          {
            "in": "path",
            "name": "mbid",
            "required": true,
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "schema": {
              "type": "string",
              "pattern": "^[0-9a-fA-F-]{36}$",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "default": "123e4567-e89b-12d3-a456-426614174000"
            },
            "examples": {
              "default": {
                "value": "123e4567-e89b-12d3-a456-426614174000"
              }
            },
            "x-example": "123e4567-e89b-12d3-a456-426614174000"
          }
        ],
        "responses": {
          "204": {
            "description": "No Content"
          },
          "400": {
            "$ref": "#/components/responses/BadRequest"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/artists/{mbid}": {
      "get": {
        "summary": "Get artist basics (bio + links)",
        "operationId": "artists_get",
        "parameters": [
          {
            "in": "path",
            "name": "mbid",
            "required": true,
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "schema": {
              "type": "string",
              "pattern": "^[0-9a-fA-F-]{36}$",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "default": "123e4567-e89b-12d3-a456-426614174000"
            },
            "examples": {
              "default": {
                "value": "123e4567-e89b-12d3-a456-426614174000"
              }
            },
            "x-example": "123e4567-e89b-12d3-a456-426614174000"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Artist"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    },
    "/artists/{mbid}/relations": {
      "get": {
        "summary": "Get artist relations",
        "operationId": "artists_relations",
        "parameters": [
          {
            "in": "path",
            "name": "mbid",
            "required": true,
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "schema": {
              "type": "string",
              "pattern": "^[0-9a-fA-F-]{36}$",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "default": "123e4567-e89b-12d3-a456-426614174000"
            },
            "examples": {
              "default": {
                "value": "123e4567-e89b-12d3-a456-426614174000"
              }
            },
            "x-example": "123e4567-e89b-12d3-a456-426614174000"
          },
          {
            "in": "query",
            "name": "types",
            "schema": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "influences",
                  "influenced_by",
                  "collaborated_with",
                  "member_of",
                  "has_members"
                ]
              },
              "uniqueItems": true
            },
            "style": "form",
            "explode": false
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/ArtistRelation"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "responses": {
      "BadRequest": {
        "description": "Bad request",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "invalid_request": {
                "summary": "Invalid request payload",
                "value": {
                  "type": "about:blank",
                  "code": "bad_request",
                  "message": "Invalid request parameters",
                  "details": {
                    "request_id": "req_123456abcdef"
                  }
                }
              }
            }
          }
        }
      },
      "NotFound": {
        "description": "Not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "missing_resource": {
                "summary": "Resource not found",
                "value": {
                  "type": "about:blank",
                  "code": "not_found",
                  "message": "Requested resource was not found",
                  "details": {
                    "request_id": "req_missing404"
                  }
                }
              }
            }
          }
        }
      },
      "TooManyRequests": {
        "description": "Too many requests",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "throttled": {
                "summary": "Rate limit exceeded",
                "value": {
                  "type": "about:blank",
                  "code": "rate_limited",
                  "message": "Too many requests",
                  "details": {
                    "request_id": "req_rate429"
                  }
                }
              }
            }
          }
        }
      },
      "Unauthorized": {
        "description": "Unauthorized",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "unauthorized": {
                "summary": "Missing or invalid credentials",
                "value": {
                  "type": "about:blank",
                  "code": "unauthorized",
                  "message": "Invalid or missing Authorization header",
                  "details": {
                    "request_id": "req_unauth123"
                  }
                }
              }
            }
          }
        }
      },
      "ServiceUnavailable": {
        "description": "Service unavailable",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "maintenance": {
                "summary": "Service temporarily unavailable",
                "value": {
                  "type": "about:blank",
                  "code": "service_unavailable",
                  "message": "Service temporarily unavailable",
                  "details": {
                    "request_id": "req_503svc"
                  }
                }
              }
            }
          }
        }
      },
      "UnprocessableEntity": {
        "description": "Unprocessable entity",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "invalid_payload": {
                "summary": "Body failed validation",
                "value": {
                  "type": "about:blank",
                  "code": "unprocessable_entity",
                  "message": "Body failed validation",
                  "details": {
                    "request_id": "req_422body"
                  }
                }
              }
            }
          }
        }
      }
    },
    "schemas": {
      "Error": {
        "type": "object",
        "required": [
          "type",
          "code",
          "message",
          "details"
        ],
        "properties": {
          "type": {
            "type": "string",
            "example": "about:blank"
          },
          "code": {
            "type": "string",
            "example": "provider_disabled"
          },
          "message": {
            "type": "string",
            "example": "TIDAL is disabled"
          },
          "details": {
            "type": "object",
            "description": "Additional metadata for debugging, always includes request_id.",
            "required": [
              "request_id"
            ],
            "additionalProperties": true,
            "properties": {
              "request_id": {
                "description": "Correlates the server log entry for this error.",
                "oneOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "null"
                  }
                ]
              }
            },
            "example": {
              "request_id": "req_abc123"
            }
          }
        }
      },
      "FileImportPreviewResponse": {
        "type": "object",
        "required": [
          "preview",
          "counts"
        ],
        "properties": {
          "preview": {
            "$ref": "#/components/schemas/PIFDocument"
          },
          "counts": {
            "type": "object",
            "required": [
              "tracks"
            ],
            "properties": {
              "tracks": {
                "type": "integer",
                "minimum": 0
              }
            }
          }
        }
      },
      "PIFDocument": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "name",
          "tracks"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "source_service": {
            "oneOf": [
              {
                "type": "string",
                "enum": [
                  "spotify",
                  "deezer",
                  "tidal",
                  "youtube",
                  "amazon"
                ]
              },
              {
                "type": "null"
              }
            ]
          },
          "source_playlist_id": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "tracks": {
            "type": "array",
            "minItems": 1,
            "items": {
              "$ref": "#/components/schemas/PIFTrack"
            }
          }
        }
      },
      "PIFTrack": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "position",
          "title",
          "artists"
        ],
        "properties": {
          "position": {
            "type": "integer",
            "minimum": 1
          },
          "title": {
            "type": "string"
          },
          "artists": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            }
          },
          "album": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "duration_ms": {
            "oneOf": [
              {
                "type": "integer",
                "minimum": 0
              },
              {
                "type": "null"
              }
            ]
          },
          "explicit": {
            "oneOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ]
          },
          "release_date": {
            "oneOf": [
              {
                "type": "string",
                "pattern": "^\\\\d{4}(-\\\\d{2}(-\\\\d{2})?)?$"
              },
              {
                "type": "null"
              }
            ]
          },
          "isrc": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "mb_recording_id": {
            "oneOf": [
              {
                "type": "string",
                "pattern": "^[0-9a-fA-F-]{36}$"
              },
              {
                "type": "null"
              }
            ]
          },
          "mb_release_id": {
            "oneOf": [
              {
                "type": "string",
                "pattern": "^[0-9a-fA-F-]{36}$"
              },
              {
                "type": "null"
              }
            ]
          },
          "provider_ids": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/PIFProviderIds"
              },
              {
                "type": "null"
              }
            ]
          }
        }
      },
      "PIFProviderIds": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "spotify_track_id": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "deezer_track_id": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "tidal_track_id": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "youtube_video_id": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "amazon_track_id": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          }
        }
      },
      "AuthProvider": {
        "type": "object",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "enum": [
              "spotify",
              "deezer",
              "tidal",
              "youtube"
            ]
          }
        }
      },
      "PagedPlaylists": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Playlist"
            }
          },
          "next_cursor": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "Playlist": {
        "type": "object",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "provider": {
            "type": [
              "string",
              "null"
            ]
          },
          "provider_playlist_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "updated_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "PagedPlaylistItems": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PlaylistItemEffective"
            }
          },
          "next_cursor": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "PlaylistItemEffective": {
        "type": "object",
        "required": [
          "id",
          "position",
          "title",
          "artists"
        ],
        "properties": {
          "id": {
            "type": "integer"
          },
          "position": {
            "type": [
              "integer",
              "null"
            ]
          },
          "title": {
            "type": "string"
          },
          "artists": {
            "type": "string"
          },
          "album": {
            "type": [
              "string",
              "null"
            ]
          },
          "duration_ms": {
            "type": [
              "integer",
              "null"
            ]
          },
          "recording_id": {
            "type": [
              "integer",
              "null"
            ]
          },
          "isrc": {
            "type": [
              "string",
              "null"
            ]
          },
          "mb_recording_id": {
            "type": [
              "string",
              "null"
            ],
            "pattern": "^[0-9a-fA-F-]{36}$",
            "example": "b8d0d7c0-8e1c-4b34-8bc3-38d78a0c2b1f"
          },
          "mb_release_id": {
            "type": [
              "string",
              "null"
            ],
            "pattern": "^[0-9a-fA-F-]{36}$",
            "example": "b7a6d2e4-1c77-4a9f-9d5b-0c3b2ea0f4a1"
          },
          "provider_track_id": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "ActivePlaylist": {
        "type": "object",
        "required": [
          "playlist_id",
          "updated_at"
        ],
        "properties": {
          "playlist_id": {
            "type": [
              "integer",
              "null"
            ]
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "JobRef": {
        "type": "object",
        "required": [
          "job_id",
          "status"
        ],
        "properties": {
          "job_id": {
            "type": "integer"
          },
          "status": {
            "type": "string",
            "enum": [
              "queued",
              "running",
              "succeeded",
              "failed"
            ]
          }
        }
      },
      "Job": {
        "type": "object",
        "required": [
          "id",
          "status",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "integer"
          },
          "status": {
            "type": "string",
            "enum": [
              "queued",
              "running",
              "succeeded",
              "failed"
            ]
          },
          "report": {
            "type": "object",
            "properties": {
              "matched_isrc_pct": {
                "type": "number"
              },
              "matched_fuzzy_pct": {
                "type": "number"
              },
              "unresolved": {
                "type": "array",
                "items": {
                  "type": "object"
                }
              }
            }
          },
          "artifact_url": {
            "type": [
              "string",
              "null"
            ],
            "format": "uri"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "Artist": {
        "type": "object",
        "required": [
          "mbid",
          "name"
        ],
        "properties": {
          "mbid": {
            "type": "string",
            "pattern": "^[0-9a-fA-F-]{36}$",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "name": {
            "type": "string"
          },
          "bio": {
            "type": [
              "object",
              "null"
            ],
            "properties": {
              "source": {
                "type": "string"
              },
              "summary": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "url": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uri"
              }
            }
          },
          "links": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "kind",
                "url"
              ],
              "properties": {
                "kind": {
                  "type": "string"
                },
                "url": {
                  "type": "string",
                  "format": "uri"
                }
              }
            }
          },
          "updated_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "ArtistRelation": {
        "type": "object",
        "required": [
          "type",
          "artist"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "influences",
              "influenced_by",
              "collaborated_with",
              "member_of",
              "has_members"
            ]
          },
          "artist": {
            "type": "object",
            "required": [
              "mbid",
              "name"
            ],
            "properties": {
              "mbid": {
                "type": "string",
                "pattern": "^[0-9a-fA-F-]{36}$",
                "example": "abcdefab-1234-5678-90ab-abcdefabcdef"
              },
              "name": {
                "type": "string"
              }
            }
          }
        }
      }
    }
  }
}
